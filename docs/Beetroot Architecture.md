# Beetroot Platform: Architecture Overview (Draft v1.1)

### 1. **System Purpose**

Beetroot is a modular, script-first, self-hosted platform designed to provision, orchestrate, and manage containerized services for homes or small businesses. It emphasizes simplicity, data ownership, local-first networking, and clean extensibility through **API-first control**.

---

### 2. **Core Components**

#### âš™ï¸ Scripts & Core Logic

|Script / Module|Purpose|
|---|---|
|`install.sh`|One-time installer, ensures system prerequisites and environment setup|
|`beetenv.py`|Auto-detects and configures service environments (.env, labels)|
|`beetsync.sh`|Updates core system files from the Git repo without overwriting user data|
|`beetgone.sh`|Uninstall script for removing beetroot and its environment|
|`beetver.sh`|Version checking and update-notification helper|

#### ğŸ§  Backend / Admin Interface

|Component|Details|
|---|---|
|`config/web/`|Python Flask backend served on port `4200`|
|Flask API|**All logic and backend operations are exposed via structured API endpoints**|
|Blueprints|Flask route groups organized per function|
|API-first design|Web interface is a client of the internal API (future-proof decoupling)|
|Access scope|API and UI are **local-only by default**, not routed through Traefik|

---

### 3. **Directory Structure**

```
beetroot/
   â”œâ”€â”€ config/ 
   â”‚   â”œâ”€â”€ scripts/
   â”‚   â””â”€â”€ web/
   |       â”œâ”€â”€ blueprints/
   |       â”œâ”€â”€ static/              # Static assets (CSS/JS if any)
   |       â”œâ”€â”€ templates/           # Admin web interface (HTML)
   |       â””â”€â”€ utils/
   â”œâ”€â”€ docker/
   â”‚   â”œâ”€â”€ chamboard/
   â”‚   â”œâ”€â”€ cloudflare/
   â”‚   â”œâ”€â”€ immich/
   â”‚   â”œâ”€â”€ traefik/
   â”‚   â””â”€â”€ wordpress/
   â”œâ”€â”€ docs/
   â””â”€â”€ shared/
       â”œâ”€â”€ backup/                  # project backup location
       â”œâ”€â”€ files/
       â”œâ”€â”€ logs/
       â””â”€â”€ library/                 # shared photo archive for immich

```

---

### 4. **Networking & Routing**

|Layer|Mechanism|
|---|---|
|Web admin|Flask app (port 4200), not routed via Traefik|
|Admin API|Serves locally over the same port, backing the UI|
|Service routing|Handled by Traefik using per-project labels|
|DNS control|(Planned) via Pi-hole API integration|

---

### 5. **Traefik Integration**

Each service folder (`docker/<project>/`) contains:

- A `docker-compose.yaml`
- Optional `.env` (auto-generated by `beetenv.py`)
- Traefik labels are validated or suggested by `beetenv`

---

### 6. **Version Management**

- The platform syncs with a public GitHub repo
- Version hash stored and checked via `beetver.sh`
- Scripts show green banner when updates are available
- Future: release tagging + admin interface notifications

---

### 7. **Web Interface Design**

|Feature|Details|
|---|---|
|Access|Served at IP:4200|
|API-first model|**Web UI is purely an API consumer** â€” no direct access to script logic|
|Separation of layers|API and admin UI are decoupled from Traefik-managed services|
|Deployment scope|Local access only, safe from internet exposure|
|Extensibility|Enables remote control (e.g., Chamboard or CLI) via the same API|

---

### 8. **Future Directions**

| Feature                  | Status       |
| ------------------------ | ------------ |
| Containerized backend    | Planned      |
| Web-based onboarding     | In progress  |
| Pi-hole DNS integration  | Planned      |
| Chamboard support        | Planned      |
| Plugin system            | Future phase |
| Family/business profiles | Future phase |
